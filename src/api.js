const API_BASE=import.meta.env.VITE_API_BASE||"https://devsite-backend-production.up.railway.app";function authHeaders(){const e=localStorage.getItem("token");return e?{Authorization:"Bearer "+e}:{}}async function safeJson(e){try{return await e.json()}catch(e){return{error:"invalid_json_response",message:e.message}}}export async function register(e,r,t=null){try{const a={username:e,password:r};t&&(a.adminSecret=t);const n=await fetch(`${API_BASE}/api/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});return await safeJson(n)}catch(e){return{error:e.message||"network_error"}}}export async function login(e,r){try{const t=await fetch(`${API_BASE}/api/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:r})});return await safeJson(t)}catch(e){return{error:e.message||"network_error"}}}export async function getMe(){try{const e=await fetch(`${API_BASE}/api/me`,{headers:{...authHeaders()}});return await safeJson(e)}catch(e){return{error:e.message||"network_error"}}}export async function listCoins(){try{const e=await fetch(`${API_BASE}/api/coins`);return await safeJson(e)}catch(e){return{error:e.message||"network_error"}}}export async function getCoin(e){try{const r=await fetch(`${API_BASE}/api/coins/${encodeURIComponent(e)}`);return await safeJson(r)}catch(e){return{error:e.message||"network_error"}}}export async function getCoinHistory(e,r=24){try{const t=await fetch(`${API_BASE}/api/coins/${encodeURIComponent(e)}/history?hours=${Number(r)}`);return await safeJson(t)}catch(e){return{error:e.message||"network_error"}}}export async function createCoin(e){try{const r=await fetch(`${API_BASE}/api/coins`,{method:"POST",headers:{"Content-Type":"application/json",...authHeaders()},body:JSON.stringify(e)});return await safeJson(r)}catch(e){return{error:e.message||"network_error"}}}export async function buyCoin(e,r){try{const t=await fetch(`${API_BASE}/api/trade/buy`,{method:"POST",headers:{"Content-Type":"application/json",...authHeaders()},body:JSON.stringify({symbol:e,usdAmount:r})});return await safeJson(t)}catch(e){return{error:e.message||"network_error"}}}export async function sellCoin(e,r){try{const t=await fetch(`${API_BASE}/api/trade/sell`,{method:"POST",headers:{"Content-Type":"application/json",...authHeaders()},body:JSON.stringify({symbol:e,tokenAmount:r})});return await safeJson(t)}catch(e){return{error:e.message||"network_error"}}}export async function getTransactions(){try{const e=await fetch(`${API_BASE}/api/transactions`,{headers:{...authHeaders()}});return await safeJson(e)}catch(e){return{error:e.message||"network_error"}}}export async function listAvailablePromoCodes(){try{const e=await fetch(`${API_BASE}/api/promocodes/available`);return await safeJson(e)}catch(e){return{error:e.message||"network_error"}}}export async function redeemPromoCode(e){try{const r=await fetch(`${API_BASE}/api/promocodes/redeem`,{method:"POST",headers:{"Content-Type":"application/json",...authHeaders()},body:JSON.stringify({code:e})});return await safeJson(r)}catch(e){return{error:e.message||"network_error"}}}export async function createPromoCode(e){try{const r=await fetch(`${API_BASE}/api/promocodes`,{method:"POST",headers:{"Content-Type":"application/json",...authHeaders()},body:JSON.stringify(e)});return await safeJson(r)}catch(e){return{error:e.message||"network_error"}}}export async function adminListPromoCodes(){try{const e=await fetch(`${API_BASE}/api/admin/promocodes`,{headers:{...authHeaders()}});return await safeJson(e)}catch(e){return{error:e.message||"network_error"}}}export async function adminListPromoRedemptions(){try{const e=await fetch(`${API_BASE}/api/admin/promocodes/redemptions`,{headers:{...authHeaders()}});return await safeJson(e)}catch(e){return{error:e.message||"network_error"}}}export async function adminGetDB(){try{const e=await fetch(`${API_BASE}/api/admin/db`,{headers:{...authHeaders()}});return await safeJson(e)}catch(e){return{error:e.message||"network_error"}}}export async function adminReplaceDB(e){try{const r=await fetch(`${API_BASE}/api/admin/db`,{method:"POST",headers:{"Content-Type":"application/json",...authHeaders()},body:JSON.stringify(e)});return await safeJson(r)}catch(e){return{error:e.message||"network_error"}}}export async function adminListUsers(){try{const e=await fetch(`${API_BASE}/api/admin/users`,{headers:{...authHeaders()}});return await safeJson(e)}catch(e){return{error:e.message||"network_error"}}}export async function adminBanUser(e,r){try{const t=await fetch(`${API_BASE}/api/admin/users/${e}/ban`,{method:"POST",headers:{"Content-Type":"application/json",...authHeaders()},body:JSON.stringify({ban:!!r})});return await safeJson(t)}catch(e){return{error:e.message||"network_error"}}}export async function adminDeleteUser(e){try{const r=await fetch(`${API_BASE}/api/admin/users/${e}`,{method:"DELETE",headers:{...authHeaders()}});return await safeJson(r)}catch(e){return{error:e.message||"network_error"}}}export async function adminListCoins(){try{const e=await fetch(`${API_BASE}/api/admin/coins`,{headers:{...authHeaders()}});return await safeJson(e)}catch(e){return{error:e.message||"network_error"}}}export async function adminDeleteCoin(e){try{const r=await fetch(`${API_BASE}/api/admin/coins/${e}`,{method:"DELETE",headers:{...authHeaders()}});return await safeJson(r)}catch(e){return{error:e.message||"network_error"}}}export async function adminUpdateCoin(e,r){try{const t=await fetch(`${API_BASE}/api/admin/coins/${e}`,{method:"PUT",headers:{"Content-Type":"application/json",...authHeaders()},body:JSON.stringify(r)});return await safeJson(t)}catch(e){return{error:e.message||"network_error"}}}export async function getLeaderboard(e="all"){try{const r=await fetch(`${API_BASE}/api/leaderboard?timeframe=${e}`,{headers:{...authHeaders()}});return await safeJson(r)}catch(e){return{error:e.message||"network_error"}}}
